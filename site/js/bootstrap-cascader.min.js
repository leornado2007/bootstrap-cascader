!function(p){"use strict";var t="bootstrap-cascader-item",r="bootstrap-cascader-panel",s={forceSelect:!1,splitChar:" ",cls:"",btnCls:"btn-default",placeHolder:"请选择",dropUp:!1,lazy:!1,openOnHover:!1,openOnHoverDelay:100,openOnHoverDelay4Lazy:200,isSelectable:function(e){return e&&(!0===e.selectable||e.loaded&&(!e.children||e.children.length<=0)&&!1!==e.selectable)}},h={containerTpl:'<div class="btn-group bootstrap-cascader form-control"></div>',btnTpl:'<button class="btn dropdown-toggle bs-placeholder" type="button">        <span class="filter-option pull-left"></span> <span class="caret icon-arrow-down"></span> <span class="icon-cross bscascader-font icon-jiaochacross78"></span>      </button>',dropdownTpl:'<ul class="dropdown-menu '+r+'"></ul>',dropdownItemTpl:'<li class="'+t+'">        <a href="javascript:">          <span class="text"></span>          <span class="bscascader-font icon-ico-right-arrow item-right-arrow"></span>          <span class="bscascader-font icon-loading item-loading"></span>          <span class="bscascader-font icon-error"></span>        </a>      </li>'},f=function(e){return e?String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):""},c=function(e,o,r){if(!e||!e.children||e.children.length<=0)r&&r(e);else{var d=this;this.setItemOpened=function(e,a){d.panelEl.children("li").removeClass("open"),a.addClass("open"),e.loaded&&0===e.children.length&&a.addClass("no-child")},this.selectItemByCode=function(e,a){d.panelEl.children('li[code="'+f(e)+'"]').trigger("selectItem",[a])},this.setSelected=function(e,a){var l=d.panelEl.children('li[code="'+f(e.code||e.c)+'"]');l.children("a").addClass("selected"),a&&d.setItemOpened(e,l),d.scrollToOpened()},this.isMatchedSelectedItems=function(e,a){for(var l=e,n=e.level-1;0<=n;n--){var t=o.selectedItems[n],s=t.code||t.c,r=l.originData;if(s!=(r.code||r.c))return!1;if(!1===a)return!0;l=l.parent}return!0},this.scrollToOpened=function(){var e=d.panelEl,a=e.find("li.open");if(a.size()<=0&&(a=e.find("li a.selected").parent()),0<a.size()){var l=e.scrollTop(),n=a.position().top+l;l<n&&(n-=(e.height()-a.height())/2,e.scrollTop(n))}},this.destroy=function(){d.panelEl.children("li").removeData("cascaderItem"),d.panelEl.remove()},this.rePosition=function(e){if(e){var a=e.panelEl,l=Number((a.css("left")||"").replace("px",""));d.panelEl.css({left:l+a.outerWidth()})}},this.handler=function(e,a,l,n){if(o.params.lazy&&!1===e.loaded){a.addClass("bs-loading");var t=e.code||e.c;d.loadingItem&&(d.loadingItem=!1),d.loadingItem=t,o.loadData(e).then(function(){d.loadingItem===t&&o.refreshPanels(e.level+1,e,n)},function(){d.loadingItem===t&&a.addClass("load-error")}).always(function(){d.loadingItem===t&&(d.setItemOpened(e,a),d.loadingItem=!1),a.removeClass("bs-loading")})}else o.refreshPanels(e.level+1,e,n),d.setItemOpened(e,a),l&&o.selectItem(e,a)},d.panelEl=p(h.dropdownTpl).appendTo(o.el),d.data=e,d.panelEl.data("dropdownPanel",d);var a=o.panels[o.panels.length-1];if(a){var l=a.panelEl,n=Number((l.css("left")||"").replace("px",""));d.panelEl.css({left:n+l.outerWidth()})}o.panels.push(d),0<o.panels.length&&(o.el.children(".dropdown-menu").removeClass("first-child last-child"),o.panels[0].panelEl.addClass("first-child"),o.panels[o.panels.length-1].panelEl.addClass("last-child"));var i=!1,c=!1;o.selectedItems.length>e.level&&(i=d.isMatchedSelectedItems(e)),p.each(e.children,function(e,a){var l=p(h.dropdownItemTpl).appendTo(d.panelEl),n=a.originData,t=n.name||n.n,s=n.code||n.c;l.data("cascaderItem",a).attr("code",s).attr("title",t).find(".text").text(t),a.loaded&&(!a.children||a.children.length<=0)&&l.addClass("no-child"),o.selectedItems.length>=a.level&&i&&d.isMatchedSelectedItems(a,!1)&&(c=!0,o.selectedItems.length>a.level?d.handler(a,l,!1,r):(o.selectedItems.length===o.panels.length&&p.each(o.selectedItems,function(e,a){o.panels[e].setSelected(a,e<o.selectedItems.length-1)}),r?(r(a),r.called=!0):(o.fireOnInit(),o.reloaded())))}),o.selectedItems.length>e.level&&!c&&o.params.lazy&&(o.isInitialized&&!o.reloading||(o.isInitialized?o.reloaded():o.fireOnInit()),r&&(r(),r.called=!0)),r&&!r.called&&r(e)}},o=function(e,a){var i=this;for(var l in e=e||{},s)"undefined"==typeof e[l]&&(e[l]=s[l]);i.params=e,i.initialized=!1,i.selectedItems=[],i.readonly=!1,i.params.value instanceof Array&&(i.selectedItems=[]);var o=function(e,s){var r=i.params.lazy;p.each(e,function(e,a){var l=a.code||a.c,n=a.data||a.d,t=s.childMap[l];t?t.loaded=!r||n&&0<n.length||!1===a.hasChild:(t={childMap:{},children:[],loaded:!r||n&&0<n.length||!1===a.hasChild,level:s.level+1,parent:s,originData:a},s.children.push(t),s.childMap[l]=t),a.selectable!==undefined&&(t.selectable=a.selectable),n&&0<n.length&&o(n,t)})},d=function(e){i.btn.attr("title",e).children(".filter-option").text(e),0<i.getValue().length?i.btn.removeClass("bs-placeholder").addClass("selected"):i.btn.addClass("bs-placeholder").removeClass("selected")},n=function(e){if(i.el.hasClass("open")){var a=p(e.target).parents(".bootstrap-cascader");0==a.size()?i.close():a[0]!=i.el[0]&&i.close()}};i.setValue=function(e,a){a=p.extend({onSetFinish:p.noop},a||{});var l,n=[],t=i.getValue();if(i.clearValue(),!e||!(e instanceof Array)||e.length<=0)return a.fireInit?i.fireOnInit():l=i.fireOnChange(t,i.getValue()),void a.onSetFinish.call(i,l);if(i.params.forceSelect){var s=function(){p.each(e,function(e,a){i.selectedItems.push({code:a.code||a.c,name:a.name||a.n}),n.push(a.name||a.n),i.panels[e]&&i.panels[e].setSelected(a,e<i.selectedItems.length-1)}),i.updateViewBySelected(function(e){e&&i.params.isSelectable(e)?d(n.join(i.params.splitChar)):i.clearValue(!1),a.fireInit?i.fireOnInit():l=i.fireOnChange(t,i.getValue()),a.onSetFinish.call(i,l)})};i.params.lazy&&i.params.loadDataByTreePath?i.loadDataByTreePath(e).then(function(){s()},function(){a.fireInit?i.fireOnInit():l=i.fireOnChange(t,i.getValue()),a.onSetFinish.call(i,l)}):s()}else p.each(e,function(e,a){i.selectedItems.push({code:a.code||a.c,name:a.name||a.n}),n.push(a.name||a.n)}),d(n.join(i.params.splitChar)),i.updateViewBySelected(),a.fireInit?i.fireOnInit():l=i.fireOnChange(t,i.getValue()),a.onSetFinish.call(i,l)},i.refreshPanels=function(e,a,l){var n=i.panels.splice(e-1,i.panels.length);n&&p.each(n,function(e,a){a.destroy()}),new c(a,i,l)},i.destroy=function(){p.each(i.panels,function(e,a){a.destroy()}),p("html").off("click",n),i.params.el.removeData("bsCascader")},i.selectItem=function(e,a){if(i.params.isSelectable.call(i,e)){i.el.find("li a").removeClass("selected"),a.children("a").addClass("selected"),i.el.find("li.open a").addClass("selected"),e=e||a.data("cascaderItem");var l=[],n=i.getValue();for(i.selectedItems=[];e.parent;){var t=e.originData,s=t.code||t.c,r=t.name||t.n;i.selectedItems.unshift({code:s,name:r}),l.unshift(r),e=e.parent}d(l.join(i.params.splitChar)),i.close(!1);var o=i.getValue();i.fireOnChange(n,o),i.params.el.trigger("bs.cascader.select",[o])}},i.fireOnChange=function(e,o){var a=!0;if(e!=o&&e.length==o.length){var d=!0;p.each(e,function(e,a){var l=a.code||a.c,n=a.name||a.n,t=o[e],s=t.code||t.c,r=t.name||t.n;if(l!=s||n!=r)return d=!1}),d&&(a=!1)}return a&&i.params.el.trigger("bs.cascader.change",[e,o]),a},i.close=function(e){i.el.removeClass("open"),!1!==e&&i.updateViewBySelected()},i.updateViewBySelected=function(e){0<i.selectedItems.length&&0<i.panels.length&&i.panels[0].selectItemByCode(i.selectedItems[0].code||i.selectedItems[0].c,e)},i.open=function(){var l;i.isReadonly()||(i.el.toggleClass("open"),p.each(i.panels,function(e,a){a.rePosition(l),a.scrollToOpened(),l=a}))},i.getValue=function(){return i.selectedItems.slice()},i.clearValue=function(e){i.selectedItems=[],i.el.find(".dropdown-menu li a").removeClass("selected"),d(i.params.placeHolder),e&&i.params.el.trigger("bs.cascader.clear")},i.setReadonly=function(e){e=!1!==e,(i.readonly=e)?(i.el.addClass("readonly"),i.btn.addClass("disabled")):(i.el.removeClass("readonly"),i.btn.removeClass("disabled"))},i.isReadonly=function(){return i.readonly},i.reload=function(){i.reloading=!0,i.data={childMap:{},children:[],loaded:!1,level:0},i.loadData().then(function(){i.refreshPanels(1,i.data),i.params.value&&i.setValue(i.params.value),i.params.lazy&&i.params.value||i.reloaded()})},i.reloaded=function(){i.reloading&&(i.reloading=!1,i.params.el.trigger("bs.cascader.reloaded"))},i.fireOnInit=function(){i.isInitialized||(i.isInitialized=!0,i.params.el.trigger("bs.cascader.inited"))},i.loadDataByTreePath=function(e){var a=p.Deferred();return i.params.loadDataByTreePath.call(i,e,function(e){e&&0<e.length?(i.data.originData||(i.data.originData=e),o(e,i.data),i.data.loaded=!0,a.resolve(e)):a.reject()}),a.promise()},i.loadData=function(a){var l=[];if(a)for(var e=a;e.parent;)l.unshift(e.originData),e=e.parent;else a=i.data;var n=p.Deferred();return i.params.loadData.call(i,l,function(e){e?(0<e.length&&((!l||l.length<=0)&&(i.data.originData=e),o(e,a)),a.loaded=!0,n.resolve(e)):n.reject()}),n.promise()},i.data={childMap:{},children:[],loaded:!1,level:0},i.panels=[],i.cols=[],i.el=p(h.containerTpl).addClass(i.params.cls),i.params.dropUp&&i.el.addClass("dropup"),i.params.replace?(i.el.insertAfter(e.el),e.el.hide()):i.el.appendTo(e.el),i.btn=p(h.btnTpl).addClass(e.btnCls).on("click",function(){i.open()}).appendTo(i.el),i.btn.children(".icon-cross").on("click",function(e){i.isReadonly()||(i.clearValue(!0),e.preventDefault(),e.stopPropagation())}),d(e.placeHolder),i.params.readonly&&i.setReadonly(!0),a.data("bsCascader",this),i.loadData().always(function(){i.refreshPanels(1,i.data),i.params.value?i.setValue(i.params.value,{fireInit:!0}):i.fireOnInit()}),p(i.el).on("selectItem","."+t,function(e,a){var l=p(e.currentTarget),n=l.data("cascaderItem");if(l&&!(l.length<=0)&&n){var t=l.closest("."+r),s=t.data("dropdownPanel");!t||t.length<=0||!s||s.handler(n,l,!1,a)}}).on("click","."+t,function(e,a){var l=p(e.currentTarget),n=l.data("cascaderItem");if(l&&!(l.length<=0)&&n){var t=l.closest("."+r),s=t.data("dropdownPanel");!t||t.length<=0||!s||s.handler(n,l,!0,a)}}).on("openDropdown","."+t,function(e){var a=p(e.currentTarget),l=a.data("cascaderItem");if(a&&!(a.length<=0)&&l){var n=a.closest("."+r),t=n.data("dropdownPanel");!n||n.length<=0||!t||t.handler(l,a)}}),i.params.openOnHover&&p(i.el).on("mouseover","."+t,function(e){var a=p(e.currentTarget),l=a.data("cascaderItem");if(a&&!(a.length<=0)&&l){var n=a.closest("."+r),t=n.data("dropdownPanel");!n||n.length<=0||!t||(i.openTimeout&&clearTimeout(i.openTimeout),i.openTimeout=setTimeout(function(){t.handler(l,a)},i.params.lazy?i.params.openOnHoverDelay4Lazy:i.params.openOnHoverDelay))}}),p("html").on("click",n)};p.fn.bsCascader=function(l){var n=arguments;return this.each(function(){if(this){var e=p(this),a=e.data("bsCascader");a||"destroy"==l||(l=p.extend({el:e,value:e.val()?e.val().split(l.splitChar||" "):""},l),a=new o(l,e)),a&&"string"==typeof l&&a[l].apply(a,Array.prototype.slice.call(n,1))}})}}(jQuery);
//# sourceMappingURL=bootstrap-cascader.min.js.map
